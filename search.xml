<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>å†…æ ¸é©±åŠ¨æ¨¡å—è¯•æ‰‹</title>
      <link href="/posts/21889.html"/>
      <url>/posts/21889.html</url>
      
        <content type="html"><![CDATA[<p>æœ¬æ–‡å†™äº†ä¸€ä¸ªéå¸¸ç®€æ˜“çš„<strong>remapé©±åŠ¨</strong>ï¼Œè¯¥é©±åŠ¨å°†æ•è·ç”¨æˆ·è°ƒç”¨çš„mmap()ï¼Œå¹¶<strong>ä¿®æ”¹</strong>å…¶åˆ†é…<strong>å†…å­˜</strong>çš„<strong>æ˜ å°„å…³ç³»</strong>ï¼šå°†å¯¹åº”è™šæ‹Ÿåœ°å€æ˜ å°„åˆ°æŒ‡å®šçš„ç‰©ç†åœ°å€ã€‚</p><h1 id="remap-c"><a href="#remap-c" class="headerlink" title="remap.c"></a>remap.c</h1><p>é©±åŠ¨æ¨¡å—æºç ï¼Œå…¶ä¸­åœ¨remap_pfn_mmapå‡½æ•°ä¸­è°ƒç”¨å†…æ ¸æä¾›çš„å‡½æ•°remap_pfn_rangeæ¥æ›´æ”¹æ˜ å°„ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/mm.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/sched/signal.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/export.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/scatterlist.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/debugfs.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/highmem.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/module.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/init.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/errno.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/pci.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/dma-mapping.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/slab.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/bitmap.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/sched.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/sched/mm.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/sched/task.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/delay.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/list.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/in.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/etherdevice.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/kernel.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/fs.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/miscdevice.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MSG <span class="string">&quot;read symbol&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">char</span>* symbol;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">int</span> <span class="title function_">remap_pfn_mmap</span><span class="params">(<span class="keyword">struct</span> file *file, <span class="keyword">struct</span> vm_area_struct *vma)</span></span><br><span class="line">&#123;</span><br><span class="line">    printk(KERN_ALERT <span class="string">&quot;np_remap \n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> pfn,phy_addr;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> ret;</span><br><span class="line"> </span><br><span class="line"><span class="type">char</span> * private_data = (<span class="type">char</span> *)kzalloc(PAGE_SIZE, GFP_KERNEL);</span><br><span class="line">    <span class="keyword">if</span> (private_data == <span class="literal">NULL</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    <span class="built_in">strcpy</span>(private_data, MSG);</span><br><span class="line">    printk(KERN_ALERT <span class="string">&quot;private_data: %s\n&quot;</span>,private_data);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(find_vma(current-&gt;mm,private_data)==<span class="literal">NULL</span>)</span><br><span class="line">        printk(KERN_ALERT <span class="string">&quot;åœ¨å†…æ ¸ä¸­ï¼Œprivate_data&#x27;s vm_area_struct is null\n&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(vma==<span class="literal">NULL</span>)</span><br><span class="line">&#123;</span><br><span class="line">printk(KERN_ALERT <span class="string">&quot;vma==NULL\n&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line">    printk(KERN_ALERT <span class="string">&quot;vma: 0x%lx\n&quot;</span>,vma);</span><br><span class="line">printk(KERN_ALERT <span class="string">&quot;vm_start: 0x%lx\n&quot;</span>,vma-&gt;vm_start);</span><br><span class="line">printk(KERN_ALERT <span class="string">&quot;virt_to_phys: 0x%lx\n&quot;</span>,virt_to_phys(private_data));</span><br><span class="line">    <span class="type">int</span> len=vma-&gt;vm_end - vma-&gt;vm_start;</span><br><span class="line">    printk(KERN_ALERT <span class="string">&quot;len: %d\n&quot;</span>,len);</span><br><span class="line">printk(KERN_ALERT <span class="string">&quot;vm_page_prot: %d\n&quot;</span>,vma-&gt;vm_page_prot);</span><br><span class="line">    </span><br><span class="line">ret=remap_pfn_range( vma, vma-&gt;vm_start, virt_to_phys(private_data)&gt;&gt;PAGE_SHIFT,vma-&gt;vm_end - vma-&gt;vm_start, vma-&gt;vm_page_prot );</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">     <span class="keyword">if</span> (ret)</span><br><span class="line">         printk(<span class="string">&quot;%s: remap_pfn_range failed at [0x%lx  0x%lx]\n&quot;</span>,</span><br><span class="line">             __func__, vma-&gt;vm_start, vma-&gt;vm_end);</span><br><span class="line">     <span class="keyword">else</span></span><br><span class="line">         printk(KERN_ALERT <span class="string">&quot;remap addr:%s\n&quot;</span>, vma-&gt;vm_start);</span><br><span class="line"> </span><br><span class="line">     <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">static</span> <span class="type">ssize_t</span> <span class="title function_">symbol_ptr_read</span><span class="params">(<span class="keyword">struct</span> file *file, <span class="type">char</span> __user * ptr, <span class="type">size_t</span> count, <span class="type">loff_t</span> *ppos)</span>&#123;</span><br><span class="line">    ptr=symbol;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="class"><span class="keyword">struct</span> <span class="title">file_operations</span> <span class="title">remap_pfn_fops</span> =</span> &#123;</span><br><span class="line">     .owner = THIS_MODULE,</span><br><span class="line">     .mmap = remap_pfn_mmap,</span><br><span class="line">     .read = symbol_ptr_read,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="class"><span class="keyword">struct</span> <span class="title">miscdevice</span> <span class="title">remap_pfn_misc</span> =</span> &#123;</span><br><span class="line">     .minor = MISC_DYNAMIC_MINOR,</span><br><span class="line">     .name = <span class="string">&quot;remap&quot;</span>,</span><br><span class="line">     .fops = &amp;remap_pfn_fops,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">int</span> __init <span class="title function_">remap_pfn_init</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line"> &#123;</span><br><span class="line">     <span class="type">int</span> ret = <span class="number">0</span>;</span><br><span class="line">     </span><br><span class="line"> </span><br><span class="line">     ret = misc_register(&amp;remap_pfn_misc);   <span class="comment">// æ³¨å†Œä¸€ä¸ªmiscè®¾å¤‡</span></span><br><span class="line">     <span class="keyword">if</span> (unlikely(ret)) &#123;</span><br><span class="line">         pr_err(<span class="string">&quot;failed to register misc device!\n&quot;</span>);</span><br><span class="line">         <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">     &#125;</span><br><span class="line"> </span><br><span class="line">     <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"> </span><br><span class="line"> err:</span><br><span class="line">     <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> __exit <span class="title function_">remap_pfn_exit</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">printk(<span class="string">&quot;%s,%d\r\n&quot;</span>, __func__, __LINE__);</span><br><span class="line">    misc_deregister(&amp;remap_pfn_misc);</span><br><span class="line"> </span><br><span class="line">     <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">module_init(remap_pfn_init);</span><br><span class="line">module_exit(remap_pfn_exit);</span><br><span class="line"> </span><br><span class="line">MODULE_LICENSE(<span class="string">&quot;GPL&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="main-c"><a href="#main-c" class="headerlink" title="main.c"></a>main.c</h1><p>ç”¨æˆ·ç¨‹åºï¼Œä½¿ç”¨è‡ªå®šä¹‰remapé©±åŠ¨å°æµ‹è¯•ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/stat.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;inttypes.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;endian.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;byteswap.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;getopt.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/time.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;arpa/inet.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/mman.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;netdb.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"> <span class="meta">#<span class="keyword">define</span> PAGE_SIZE (4*1024)</span></span><br><span class="line"> <span class="meta">#<span class="keyword">define</span> BUF_SIZE getpagesize()</span></span><br><span class="line"> <span class="meta">#<span class="keyword">define</span> OFFSET (0)</span></span><br><span class="line"> </span><br><span class="line"> <span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> *argv[])</span></span><br><span class="line"> &#123;</span><br><span class="line">     <span class="type">int</span> fd;</span><br><span class="line">     <span class="type">char</span> *addr = <span class="string">&quot;not null&quot;</span>;</span><br><span class="line">     fd = open(<span class="string">&quot;/dev/remap&quot;</span>, O_RDWR);</span><br><span class="line"></span><br><span class="line">     <span class="built_in">printf</span>(<span class="string">&quot;mmap before==&gt;addr: %s\n&quot;</span>, addr);</span><br><span class="line">     addr = mmap(<span class="literal">NULL</span>, BUF_SIZE, PROT_READ | PROT_WRITE, MAP_SHARED | MAP_LOCKED, fd, OFFSET);   </span><br><span class="line">     <span class="built_in">printf</span>(<span class="string">&quot;mmap after==&gt;addr: %s\n&quot;</span>, addr); </span><br><span class="line">     </span><br><span class="line">     <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="makefileæ–‡ä»¶"><a href="#makefileæ–‡ä»¶" class="headerlink" title="makefileæ–‡ä»¶"></a>makefileæ–‡ä»¶</h1><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†…æ ¸çš„æºç è·¯å¾„, ?= æ¡ä»¶èµ‹å€¼, uname -r  å¾—åˆ°å†…æ ¸çš„ç‰ˆæœ¬å·</span></span><br><span class="line">KERNELDIR = /lib/modules/<span class="variable">$(<span class="built_in">shell</span> uname -r)</span>/build  </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment"># ç”Ÿæˆæ¨¡å—</span></span><br><span class="line">obj-m := remap.o </span><br><span class="line"> </span><br><span class="line"><span class="comment"># := ç«‹å³èµ‹å€¼, å¾—åˆ°å½“å‰çš„ç»å¯¹è·¯å¾„</span></span><br><span class="line">PWD := <span class="variable">$(<span class="built_in">shell</span> pwd)</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment"># -C åˆ‡æ¢å·¥ä½œè·¯å¾„, make -c</span></span><br><span class="line"><span class="section">modules:</span></span><br><span class="line"><span class="variable">$(MAKE)</span> -C <span class="variable">$(KERNELDIR)</span> M=<span class="variable">$(PWD)</span> modules</span><br><span class="line"> </span><br><span class="line"><span class="section">clean:</span></span><br><span class="line">rm -rf *.o *~ core .depend .*.cmd *.ko *.mod.c .tmp_versions Module* modules* *.mod</span><br><span class="line"> </span><br><span class="line"><span class="meta"><span class="keyword">.PHONY</span>: modules  clean</span></span><br></pre></td></tr></table></figure><h1 id="è¿è¡Œrun"><a href="#è¿è¡Œrun" class="headerlink" title="è¿è¡Œrun!"></a>è¿è¡Œrun!</h1><h3 id="åŠ è½½é©±åŠ¨æ¨¡å—"><a href="#åŠ è½½é©±åŠ¨æ¨¡å—" class="headerlink" title="åŠ è½½é©±åŠ¨æ¨¡å—"></a>åŠ è½½é©±åŠ¨æ¨¡å—</h3><p>ps: ä¸Šé¢ä¸‰ä¸ªæ–‡ä»¶éœ€è¦åœ¨åŒä¸€ä¸ªç›®å½•ä¸‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è½¬rootç”¨æˆ·ï¼Œåœ¨æ–‡ä»¶ç›®å½•ä¸‹</span></span><br><span class="line"><span class="comment"># ç¼–è¯‘remapé©±åŠ¨æºç </span></span><br><span class="line">make</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†é©±åŠ¨æ¨¡å—åŠ è½½åˆ°å†…æ ¸ä¸­</span></span><br><span class="line">insmode remap.ko</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†é©±åŠ¨æ¨¡å—ä»å†…æ ¸ä¸­ç§»é™¤</span></span><br><span class="line">rmmode remap.ko</span><br></pre></td></tr></table></figure><h3 id="ç¼–è¯‘è¿è¡Œç”¨æˆ·ç¨‹åº"><a href="#ç¼–è¯‘è¿è¡Œç”¨æˆ·ç¨‹åº" class="headerlink" title="ç¼–è¯‘è¿è¡Œç”¨æˆ·ç¨‹åº"></a>ç¼–è¯‘è¿è¡Œç”¨æˆ·ç¨‹åº</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è½¬rootç”¨æˆ·ï¼Œåœ¨æ–‡ä»¶ç›®å½•ä¸‹</span></span><br><span class="line">gcc -o main main.c</span><br><span class="line">./main</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> linuxå­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linuxå†…æ ¸ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RDMAåŸºæœ¬æœåŠ¡ç±»å‹</title>
      <link href="/posts/9078.html"/>
      <url>/posts/9078.html</url>
      
        <content type="html"><![CDATA[<p>ğŸ±PSï¼š</p><p>æœ¬æ–‡æ˜¯å¯¹è¯¥åšå®¢ï¼ˆ<a href="https://zhuanlan.zhihu.com/p/144099636">https://zhuanlan.zhihu.com/p/144099636</a>ï¼‰çš„ä¸€ä¸ªå­¦ä¹ ç¬”è®°ã€‚</p><p>è‹¥è€ƒè™‘ä½¿ç”¨å“ªç§æœåŠ¡ç±»å‹çš„QPï¼ŒæŒ‡è·¯ï¼š<a href="https://www.rdmamojo.com/2013/06/01/which-queue-pair-type-to-use/">https://www.rdmamojo.com/2013/06/01/which-queue-pair-type-to-use/</a></p><h1 id="å¯é æœåŠ¡"><a href="#å¯é æœåŠ¡" class="headerlink" title="å¯é æœåŠ¡"></a>å¯é æœåŠ¡</h1><p>IBåè®®ä¸­æ˜¯è¿™æ ·æè¿°å¯é æœåŠ¡çš„ï¼šå¯é æœåŠ¡åœ¨å‘é€å’Œæ¥å—è€…ä¹‹é—´ä¿è¯äº†ä¿¡æ¯æœ€å¤šåªä¼šä¼ é€’ä¸€æ¬¡ï¼Œå¹¶ä¸”èƒ½å¤Ÿä¿è¯å…¶æŒ‰ç…§å‘é€é¡ºåºè¢«æ¥æ”¶ã€‚</p><p>IBé€šè¿‡ä»¥ä¸‹ä¸‰ä¸ªæœºåˆ¶æ¥ä¿è¯å¯é æ€§ï¼š</p><ul><li>åœ¨IBåè®®çš„å¯é æœåŠ¡ç±»å‹ä¸­ï¼Œä½¿ç”¨äº†<strong>åº”ç­”æœºåˆ¶</strong>æ¥ä¿è¯æ•°æ®åŒ…è¢«å¯¹æ–¹æ”¶åˆ°ã€‚å³æ¥æ”¶ç«¯åœ¨æ¥æ”¶åˆ°æ•°æ®åŒ…åè¿”å›ACKã€‚IBçš„å¯é æœåŠ¡ç±»å‹ä¸­ï¼Œæ¥æ”¶æ–¹ä¸æ˜¯æ¯ä¸€ä¸ªåŒ…éƒ½å¿…é¡»å›å¤ï¼Œä¹Ÿå¯ä»¥ä¸€æ¬¡å›å¤å¤šä¸ªåŒ…çš„ACKã€‚</li><li>IBåè®®ä½¿ç”¨CRCè¿›è¡Œ<strong>æ•°æ®æ ¡éªŒ</strong>ã€‚å‘ç«¯ä¼šå¯¹Headerå’ŒPayloadï¼ˆæœ‰æ•ˆè½½è·ï¼Œä¹Ÿå°±æ˜¯çœŸæ­£è¦æ”¶å‘çš„æ•°æ®ï¼‰é€šè¿‡ä¸€å®šçš„ç®—æ³•å¾—åˆ°ä¸€ä¸ªæ ¡éªŒå€¼æ”¾åˆ°æ•°æ®åŒ…çš„æœ«å°¾ã€‚å¯¹ç«¯æ”¶åˆ°æ•°æ®åŒ…åï¼Œä¹Ÿä¼šç”¨ç›¸åŒçš„ç®—æ³•è®¡ç®—å‡ºæ ¡éªŒå€¼ï¼Œç„¶åä¸æ•°æ®åŒ…ä¸­çš„æ ¡éªŒå€¼æ¯”å¯¹ï¼Œå¦‚æœä¸ä¸€è‡´ï¼Œè¯´æ˜æ•°æ®ä¸­åŒ…å«é”™è¯¯ï¼ˆä¸€èˆ¬æ˜¯é“¾è·¯é—®é¢˜å¯¼è‡´çš„ï¼‰ï¼Œé‚£ä¹ˆæ¥æ”¶ç«¯å°±ä¼šä¸¢å¼ƒè¿™ä¸ªæ•°æ®åŒ…ã€‚</li><li>IBåè®®ä¸­æœ‰PSNï¼ˆPacket Sequence Numberï¼ŒåŒ…åºå·ï¼‰è¿›è¡Œ<strong><strong>ä¿åº</strong></strong>ï¼Œå³æ¯ä¸ªåŒ…éƒ½æœ‰ä¸€ä¸ªé€’å¢çš„ç¼–å·ã€‚PSNå¯ä»¥ç”¨æ¥æ£€æµ‹æ˜¯å¦ä¸¢åŒ…ï¼Œæ¯”å¦‚æ”¶ç«¯æ”¶åˆ°äº†1ï¼Œä½†æ˜¯åœ¨æ²¡æ”¶åˆ°2çš„æƒ…å†µä¸‹å°±æ”¶åˆ°äº†3ï¼Œé‚£ä¹ˆå…¶å°±ä¼šè®¤ä¸ºä¼ è¾“è¿‡ç¨‹ä¸­å‘ç”Ÿäº†é”™è¯¯ï¼Œä¹‹åä¼šå›å¤ä¸€ä¸ªNAKç»™å‘ç«¯ï¼Œè®©å…¶é‡å‘ä¸¢å¤±çš„åŒ…ã€‚<ul><li>PSNæ˜¯æ¯ä¸ªQPéƒ½å…·æœ‰çš„ï¼Œä¸åŒQPé—´æ˜¯ç›¸äº’ç‹¬ç«‹çš„ã€‚</li></ul></li></ul><blockquote><p>ICRC æ ¡éªŒå‘ç”Ÿåœ¨IBé“¾è·¯å±‚, è€ŒNAKæ˜¯IB ä¼ è¾“å±‚çš„åŠŸèƒ½ã€‚NAKä¼šå‘ç”Ÿï¼Œä½†æ˜¯å‘ç”Ÿåœ¨ä¸‹ä¸€ä¸ªpacket (with no ICRC error)ã€‚æ¯”å¦‚ï¼ŒPSNä¸º10çš„æ•°æ®åŒ…åœ¨ä¼ è¾“åˆ°å“åº”æ–¹æ—¶å‡ºç°äº†æŸç§æŸåï¼Œç”±äºICRCé”™è¯¯ï¼Œå“åº”æ–¹IBé“¾è·¯å±‚å°†ä¼šä¸¢å¼ƒè¯¥æ•°æ®åŒ…ã€‚è¿™æ—¶IB ä¼ è¾“å±‚ ä¼šçœ‹åˆ° PSN&#x3D;9 åé¢è·Ÿç€ PSN&#x3D;11ã€‚PSN&#x3D;11 ä¼šè§¦å‘IBä¼ è¾“å±‚å‘èµ·NAKã€‚</p></blockquote><aside>ğŸ’¡ æ ‡å‡†çš„IBè§„èŒƒä¸ä¼šç­‰å¾…é‡æ–°æ’åºã€‚æ¯”å¦‚ï¼ŒPSN=2å‘ç”Ÿé”™è¯¯è¢«ä¸¢å¼ƒï¼Œå½“PSN=3æ”¶åˆ°æ—¶ï¼ŒIB ä¼ è¾“å±‚é©¬ä¸Šå°±ä¼šå‘èµ·ä¸€ä¸ªNAKï¼ˆPSN=2ï¼‰ï¼Œå¹¶ä¸ä¼šèŠ±æ—¶é—´ç­‰2ã€‚</aside><aside>ğŸ’¡ CRCæ˜¯ç¡¬ä»¶å®Œæˆçš„ï¼ŒCPUä¸å‚ä¸æŠ¥æ–‡å¤„ç†ã€‚å¯¹äºSoft-RoCEå’ŒSoft-iWARPæ¥è¯´ï¼Œå®ƒä»¬çš„CRCæ ¡éªŒåªèƒ½ç”±CPUæ¥å®Œæˆï¼Œè¿™å¯¹æ€§èƒ½å½±å“å¾ˆå¤§ã€‚</aside><aside>ğŸ’¡ CRCä¿è¯çš„æ˜¯å•ä¸ªæŠ¥æ–‡çš„æ­£ç¡®æ€§ï¼Œå½“åº•å±‚å°†å¤§æ•°æ®è¿›è¡Œæ‹†åŒ…æ—¶ï¼Œéœ€è¦å¯¹æ¯ä¸€ä¸ªå°åŒ…è¿›è¡Œè®¡ç®—ã€‚</aside><h1 id="ä¸å¯é æœåŠ¡"><a href="#ä¸å¯é æœåŠ¡" class="headerlink" title="ä¸å¯é æœåŠ¡"></a>ä¸å¯é æœåŠ¡</h1><p>æ²¡æœ‰ä¸Šè¿°è¿™äº›æœºåˆ¶æ¥ä¿è¯æ•°æ®åŒ…è¢«æ­£ç¡®çš„æ¥æ”¶ï¼Œå±äºâ€œå‘å‡ºå»å°±è¡Œï¼Œæˆ‘ä¸å…³å¿ƒæœ‰æ²¡æœ‰è¢«æ”¶åˆ°â€çš„æœåŠ¡ç±»å‹ã€‚</p><h1 id="åŸºäºè¿æ¥çš„æœåŠ¡"><a href="#åŸºäºè¿æ¥çš„æœåŠ¡" class="headerlink" title="åŸºäºè¿æ¥çš„æœåŠ¡"></a>åŸºäºè¿æ¥çš„æœåŠ¡</h1><p>æ¯ä¸ªQPéƒ½å’Œå¦ä¸€ä¸ªè¿œç«¯èŠ‚ç‚¹ç›¸å…³è”ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒQP Contextï¼ˆç®€ç§°QPCï¼‰ä¸­åŒ…å«æœ‰è¿œç«¯èŠ‚ç‚¹çš„QPä¿¡æ¯ã€‚åœ¨å»ºç«‹é€šä¿¡çš„è¿‡ç¨‹ä¸­ï¼Œä¸¤ä¸ªèŠ‚ç‚¹ä¼šäº¤æ¢åŒ…æ‹¬ç¨åç”¨äºé€šä¿¡çš„QPåœ¨å†…çš„å¯¹ç«¯ä¿¡æ¯ã€‚<strong>åœ¨è¿æ¥æœåŠ¡ç±»å‹ä¸­çš„æ¯ä¸ªQPï¼Œéƒ½å’Œå”¯ä¸€çš„å¦ä¸€ä¸ªQPå»ºç«‹äº†è¿æ¥ï¼Œ</strong>ä¹Ÿå°±æ˜¯è¯´QPä¸‹å‘çš„æ¯ä¸ªWQEçš„ç›®çš„åœ°éƒ½æ˜¯å”¯ä¸€çš„ã€‚</p><h1 id="åŸºäºæ•°æ®æŠ¥çš„æœåŠ¡"><a href="#åŸºäºæ•°æ®æŠ¥çš„æœåŠ¡" class="headerlink" title="åŸºäºæ•°æ®æŠ¥çš„æœåŠ¡"></a>åŸºäº<strong>æ•°æ®æŠ¥</strong>çš„æœåŠ¡</h1><p>ä¸è¿æ¥ç›¸åï¼Œå‘ç«¯å’Œæ”¶ç«¯é—´ä¸éœ€è¦â€œå»ºç«‹ç®¡é“â€çš„æ­¥éª¤ï¼Œåªè¦å‘ç«¯åˆ°æ”¶ç«¯ç‰©ç†ä¸Šæ˜¯å¯ä»¥åˆ°è¾¾çš„ï¼Œé‚£ä¹ˆæˆ‘å°±å¯èƒ½ä»ä»»ä½•è·¯å¾„å‘ç»™ä»»æ„çš„æ”¶ç«¯èŠ‚ç‚¹ã€‚</p><ul><li><p>IBåè®®å¯¹å…¶çš„å®šä¹‰æ˜¯è¿™æ ·çš„ï¼š</p><p>å¯¹äºæ•°æ®æŠ¥æœåŠ¡æ¥è¯´ï¼ŒQPä¸ä¼šè·Ÿä¸€ä¸ªå”¯ä¸€çš„è¿œç«¯èŠ‚ç‚¹ç»‘å®šï¼Œè€Œæ˜¯<strong>é€šè¿‡WQEæ¥æŒ‡å®šç›®çš„èŠ‚ç‚¹</strong>ã€‚å’Œè¿æ¥ç±»å‹çš„æœåŠ¡ä¸€æ ·ï¼Œå»ºç«‹é€šä¿¡çš„è¿‡ç¨‹ä¹Ÿéœ€è¦ä¸¤ç«¯äº¤æ¢å¯¹ç«¯ä¿¡æ¯ï¼Œä½†æ˜¯æ•°æ®æŠ¥æœåŠ¡å¯¹äºæ¯ä¸ªç›®çš„èŠ‚ç‚¹éƒ½éœ€è¦æ‰§è¡Œä¸€æ¬¡è¿™ä¸ªäº¤æ¢è¿‡ç¨‹ã€‚</p></li></ul><p>æ¯”å¦‚ï¼Œåœ¨æ•°æ®æŠ¥ç±»å‹çš„QPçš„Contextä¸­ï¼Œä¸åŒ…å«å¯¹ç«¯ä¿¡æ¯ï¼Œå³æ¯ä¸ªQPä¸è·Ÿå¦ä¸€ä¸ªQPç»‘å®šã€‚QPä¸‹å‘ç»™ç¡¬ä»¶çš„<strong>æ¯ä¸ªWQE</strong>éƒ½å¯èƒ½<strong>æŒ‡å‘ä¸åŒçš„ç›®çš„åœ°</strong>ã€‚ä¸è¿æ¥æœåŠ¡ç±»å‹ä¸€æ ·ï¼Œæœ¬ç«¯QPå¯ä»¥å’Œå“ªä¸ªå¯¹ç«¯QPå‘é€æ•°æ®ï¼Œæ˜¯åœ¨å‡†å¤‡é˜¶æ®µæå‰é€šè¿‡æŸäº›æ–¹å¼ç›¸äº’å‘ŠçŸ¥çš„ã€‚è¿™ä¹Ÿæ˜¯ä¸Šæ–‡â€œæ•°æ®æŠ¥æœåŠ¡å¯¹äºæ¯ä¸ªç›®çš„èŠ‚ç‚¹éƒ½éœ€è¦æ‰§è¡Œä¸€æ¬¡è¿™ä¸ªäº¤æ¢è¿‡ç¨‹â€çš„å«ä¹‰ã€‚</p><aside>ğŸ’¡ åœ¨åŸºäºè¿æ¥çš„æœåŠ¡ä¸­ï¼Œä¸€å¯¹ä¸€è¿æ¥éœ€è¦å­˜å‚¨æ›´å¤šçš„contextæˆ–dataä»¥ç»´æŒä¸€å¯¹ä¸€è¿æ¥çŠ¶æ€ï¼Œä½†æ•°æ®æŠ¥ä¸éœ€è¦å­˜å‚¨é‚£ä¹ˆå¤šçš„æ•°æ®ã€‚ä¸è¿‡è¿æ¥å¯ä»¥åšåˆ°bypass CPUï¼Œä½†æ•°æ®æŠ¥ä¸èƒ½bypass CPUã€‚</aside><h1 id="RC"><a href="#RC" class="headerlink" title="RC"></a>RC</h1><p>åŸºäºè¿æ¥çš„å¯é æœåŠ¡ï¼Œç±»æ¯”TCP&#x2F;IPåè®®æ ˆä¼ è¾“å±‚çš„TCPã€‚</p><p>RCç”¨äºå¯¹æ•°æ®å®Œæ•´æ€§å’Œå¯é æ€§è¦æ±‚è¾ƒé«˜çš„åœºæ™¯ï¼Œè·ŸTCPä¸€æ ·ï¼Œå› ä¸ºéœ€è¦å„ç§æœºåˆ¶æ¥ä¿è¯å¯é ï¼Œæ‰€ä»¥å¼€é”€è‡ªç„¶ä¼šå¤§ä¸€äº›ã€‚</p><p>ç”±äºRCæœåŠ¡ç±»å‹å’Œæ¯ä¸ªèŠ‚ç‚¹é—´éœ€è¦å„è‡ªç»´æŠ¤ä¸€ä¸ªQPï¼Œå‡è®¾æœ‰Nä¸ªèŠ‚ç‚¹è¦ç›¸äº’é€šä¿¡ï¼Œé‚£ä¹ˆè‡³å°‘éœ€è¦**N * (N - 1)**ä¸ªQPï¼Œè€ŒQPå’ŒQPCæœ¬èº«æ˜¯éœ€è¦å ç”¨ç½‘å¡èµ„æºæˆ–è€…å†…å­˜çš„ï¼Œå½“èŠ‚ç‚¹æ•°å¾ˆå¤šæ—¶ï¼Œå­˜å‚¨èµ„æºæ¶ˆè€—å°†ä¼šéå¸¸å¤§ã€‚</p><h1 id="UC"><a href="#UC" class="headerlink" title="UC"></a>UC</h1><p>åŸºäºè¿æ¥çš„ä¸å¯é æœåŠ¡ã€‚</p><ul><li><p>æ³¨æ„UCæ”¯æŒWRITEå´ä¸æ”¯æŒREADæ“ä½œ</p><blockquote><p>å› ä¸ºreadéœ€è¦è¯·æ±‚ç«¯ç½‘å¡ä¿å­˜ä¸Šä¸‹æ–‡ç­‰ä¿¡æ¯ï¼ˆæ¯”å¦‚ä¿å­˜ä¸€äº›çŠ¶æ€ä»¥ç­‰å¾…æŸä¸ªå‘å‡ºå»çš„READè¿”å›æ•°æ®ï¼‰ï¼Œå¦‚æœæ˜¯ä¸å¯é çš„è¯ï¼Œ<strong>åŒ…ä¸¢å¤±ä¼šé€ æˆç½‘å¡æ°¸ä¹…ç­‰å¾…READè¿”å›</strong>ï¼Œè¿™ç§è¡Œä¸ºä¸å¤ªç¬¦åˆå¸¸ç†ï¼Œå› æ­¤ä¸å¯é è¿æ¥æ— æ³•æ”¯æŒREADï¼›</p></blockquote></li></ul><h1 id="RD"><a href="#RD" class="headerlink" title="RD"></a>RD</h1><p>åŸºäºæ•°æ®æŠ¥çš„å¯é æœåŠ¡ã€‚å„å‚å•†é€‰æ‹©å®ç°æ˜¯å¦æ”¯æŒè¯¥æœåŠ¡ã€‚</p><h1 id="UD"><a href="#UD" class="headerlink" title="UD"></a>UD</h1><p>åŸºäºæ•°æ®æŠ¥çš„ä¸å¯é æœåŠ¡ï¼Œç±»æ¯”TCP&#x2F;IPåè®®æ ˆä¼ è¾“å±‚çš„UDPã€‚</p><p>UDç¡¬ä»¶å¼€é”€å°å¹¶ä¸”èŠ‚çœå­˜å‚¨èµ„æºï¼Œæ¯”å¦‚Nä¸ªèŠ‚ç‚¹éœ€è¦ç›¸äº’é€šä¿¡ï¼Œåªéœ€è¦åˆ›å»º<strong>N</strong>ä¸ªQPå°±å¯ä»¥äº†ï¼Œä½†æ˜¯å¯é æ€§è·ŸUDPä¸€æ ·æ²¡æ³•ä¿è¯ã€‚ç”¨æˆ·å¦‚æœæƒ³åŸºäºUDæœåŠ¡ç±»å‹å®ç°å¯é æ€§ï¼Œé‚£ä¹ˆéœ€è¦è‡ªå·±åŸºäºIBä¼ è¾“å±‚å®ç°åº”ç”¨å±‚çš„å¯é ä¼ è¾“æœºåˆ¶ã€‚</p><ul><li><p>æ³¨æ„UDä¸æ”¯æŒWRITEæ“ä½œï¼Œåªèƒ½ç”¨äºSEND</p><blockquote><p>æ— è®ºæ˜¯å¯é è¿æ¥è¿˜æ˜¯ä¸å¯é è¿æ¥ï¼Œéƒ½è¦æ±‚QPä¸€å¯¹ä¸€è¿æ¥ï¼ˆå³æ–‡ä¸­çš„â€œå»ºç«‹ç®¡é“â€ï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´READå’ŒWRITEéƒ½éœ€è¦ä¸€å¯¹ä¸€è¿æ¥ï¼Œä½†æ•°æ®æŠ¥æ— éœ€ä¸€å¯¹ä¸€è¿æ¥ï¼Œå› æ­¤æ²¡æœ‰ä¸€å¯¹ä¸€è¿æ¥è¿™ä¸ªå‰æï¼Œæ‰€ä»¥æ— æ³•æ”¯æŒWRITE</p></blockquote></li></ul><h1 id="å„æœåŠ¡ç±»å‹æ”¯æŒçš„æ“ä½œ"><a href="#å„æœåŠ¡ç±»å‹æ”¯æŒçš„æ“ä½œ" class="headerlink" title="å„æœåŠ¡ç±»å‹æ”¯æŒçš„æ“ä½œ"></a>å„æœåŠ¡ç±»å‹æ”¯æŒçš„æ“ä½œ</h1><p><img src="/img/4pic.png" alt="Untitled"></p><h1 id="ä¸€äº›é—®é¢˜åŠå›ç­”"><a href="#ä¸€äº›é—®é¢˜åŠå›ç­”" class="headerlink" title="ä¸€äº›é—®é¢˜åŠå›ç­”"></a>ä¸€äº›é—®é¢˜åŠå›ç­”</h1><p>å¦‚æœä¸€ä¸ªqpå ç”¨äº†æŸudp src portï¼ŒåŒä¸€æœºå™¨ä¸Šçš„érdma çš„ udpç¨‹åºè¿˜èƒ½ç”¨è¿™ä¸ªudp æºç«¯å£å·å—ï¼Ÿ</p><blockquote><p>å¯ä»¥å¤ç”¨ï¼ŒIBè§„èŒƒå¯¹è¿™ä¸ªUDP Source Portæ²¡æœ‰åšè§„å®šï¼Œä¸€èˆ¬æ˜¯ç”¨è¿™ä¸ªåŸŸæ®µåšé“¾è·¯é—´çš„è´Ÿè½½å‡è¡¡ã€‚æœ‰çš„å‚å•†é€šè¿‡é©±åŠ¨é‡ŒåšHASHå¾—å‡ºä¸€ä¸ªå€¼ç„¶åé…åˆ°äº†ç¡¬ä»¶é‡Œï¼Œæœ‰çš„å‚å•†ç”šè‡³éƒ½æ²¡æœ‰åšï¼Œä¼°è®¡æ˜¯ä¸ªéšæœºå€¼æˆ–è€…å›ºå®šå€¼ã€‚</p></blockquote><p>rdmaä¸­rcå’Œudèƒ½å¦æ‹¥æœ‰ç›¸åŒçš„qp numberï¼Œç½‘å¡é©±åŠ¨æ ¹æ®qp typeè¿›è¡ŒåŒºåˆ†ï¼Ÿ</p><blockquote><p>ä¸å¯ä»¥ã€‚è¿™ä¸æ­¢æ˜¯ä¿®æ”¹é©±åŠ¨çš„é—®é¢˜ï¼Œä»APIã€æ•´ä¸ªRDMAè½¯ä»¶æ ˆå’Œç¡¬ä»¶å®ç°æ¥çœ‹ï¼ŒQPç±»å‹å’ŒQPNéƒ½æ˜¯QPçš„å›ºæœ‰å±æ€§ä¹‹ä¸€ï¼ŒQPç±»å‹ä¸åŒï¼Œè°ƒç”¨APIæ—¶ä¼ é€’çš„å‚æ•°ã€è½¯ä»¶æ ˆçš„å¤„ç†ã€QPC&#x2F;WQEçš„å¸ƒå±€ã€ç¡¬ä»¶çš„å¤„ç†éƒ½ä¼šæœ‰å·®å¼‚ã€‚è™½ç„¶ç†è®ºä¸Šå¯ä»¥è¿™ä¹ˆæï¼Œä½†æ˜¯ä»£ä»·æ˜¯ç ´åäº†ä¸€ä¸ªæˆç†Ÿçš„æ ‡å‡†ï¼Œç›¸å½“äºè‡ªå·±é‡æ–°å®šä¹‰äº†ä¸€ç§åè®®ã€‚</p></blockquote><p>RCå’ŒUDå®ƒä»¬çš„å…·ä½“åº”ç”¨åœºæ™¯æ˜¯åœ¨å“ªé‡Œï¼Ÿ</p><blockquote><p>RCç”¨åœ¨å¯¹å¯é æ€§è¦æ±‚è¾ƒé«˜çš„åœºæ™¯ï¼Œä½†æ˜¯å› ä¸ºéœ€è¦å»ºç«‹å¾ˆå¤šQPæ¥ç»´æŒè¿›ç¨‹é—´çš„è¿æ¥ï¼Œæ‰€ä»¥å¯¹å†…å­˜çš„æ¶ˆè€—å¾ˆå¤§ã€‚ä½¿ç”¨UDçš„è¯ï¼Œæ¯ä¸ªè¿›ç¨‹åªéœ€è¦ä¿ç•™ä¸€ä¸ªQPå°±å¯å®ç°å¯¹æ•´ä¸ªç»„ç½‘å†…çš„å…¶ä»–è¿›ç¨‹é€šä¿¡ï¼Œä½†æ˜¯å¯é æ€§éœ€è¦ç”±ä¸Šå±‚ä¿è¯ã€‚æ­¤å¤–è¿˜æœ‰ä¸€ç§XRCæœåŠ¡ï¼Œç›¸æ¯”äºRCå¯ä»¥èŠ‚çœé€šä¿¡æ‰€éœ€çš„QPæ•°ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> RDMAå­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RDMA </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å®‰è£…linuxå†…æ ¸æ•™ç¨‹</title>
      <link href="/posts/2366.html"/>
      <url>/posts/2366.html</url>
      
        <content type="html"><![CDATA[<h1 id="æ–¹æ³•ä¸€"><a href="#æ–¹æ³•ä¸€" class="headerlink" title="æ–¹æ³•ä¸€"></a>æ–¹æ³•ä¸€</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£…æ‰€éœ€ä¾èµ–åŒ…</span></span><br><span class="line">sudo apt install build-essential libncurses5-dev fakeroot xz-utils</span><br><span class="line">sudo apt install flex libdaemon-dev libbison-dev libelf-dev</span><br><span class="line">sudo apt-get install libssl-dev</span><br><span class="line">sudo apt-get install dwarves</span><br><span class="line"></span><br><span class="line"><span class="comment"># å»å®˜ç½‘ä¸‹è½½ä½ æƒ³è¦å®‰è£…çš„å†…æ ¸ç‰ˆæœ¬ï¼Œç„¶åè§£å‹åˆ°/lib/modulesç›®å½•ä¸‹</span></span><br><span class="line"><span class="built_in">cd</span> å†…æ ¸æºç æ–‡ä»¶å¤¹</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºå†…æ ¸é…ç½®æ–‡ä»¶</span></span><br><span class="line">sudo make menuconfig</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¼–è¯‘å†…æ ¸æºç </span></span><br><span class="line">sudo make -j16</span><br><span class="line"></span><br><span class="line"><span class="comment"># å†…æ ¸æ¨¡å—å®‰è£…</span></span><br><span class="line">sudo make modules_install</span><br><span class="line"></span><br><span class="line"><span class="comment"># å†…æ ¸å®‰è£…</span></span><br><span class="line">sudo make install</span><br></pre></td></tr></table></figure><h1 id="æ–¹æ³•äºŒ"><a href="#æ–¹æ³•äºŒ" class="headerlink" title="æ–¹æ³•äºŒ"></a>æ–¹æ³•äºŒ</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ‹·è´åŸæ¥çš„å†…æ ¸é…ç½®æ–‡ä»¶</span></span><br><span class="line">sudo <span class="built_in">cp</span> /boot/config-`<span class="built_in">uname</span> -r`* .config</span><br><span class="line"></span><br><span class="line"><span class="comment"># é…ç½®å†…æ ¸</span></span><br><span class="line">sudo make defconfig</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¼–è¯‘å†…æ ¸å¹¶å®‰è£…</span></span><br><span class="line">sudo make -j$(<span class="built_in">nproc</span>)</span><br><span class="line">sudo make modules_install install</span><br></pre></td></tr></table></figure><blockquote><p>psï¼šæ–¹æ³•ä¸€å’Œæ–¹æ³•äºŒæˆ‘éƒ½è¯•è¿‡ï¼Œå¯ä»¥æˆåŠŸå®‰è£…</p></blockquote><p><strong>è®°å½•ä¸€ä¸‹å®‰è£…å†…æ ¸å¤„ç†è¿‡çš„é”™è¯¯ï¼š</strong></p><p><a href="https://blog.csdn.net/m0_47696151/article/details/121574718">(111æ¡æ¶ˆæ¯) ç¼–è¯‘å†…æ ¸æŠ¥é”™ No rule to make target â€˜debian&#x2F;canonical-certs.pemâ€˜ æˆ– â€˜canonical-revoked-certs.pemâ€˜ çš„è§£å†³æ–¹æ³•_lylhw13_çš„åšå®¢-CSDNåšå®¢</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo scripts/config --<span class="built_in">disable</span> SYSTEM_TRUSTED_KEYS</span><br><span class="line">sudo scripts/config --<span class="built_in">disable</span> SYSTEM_REVOCATION_KEYS</span><br><span class="line">sudo make <span class="comment"># sudo make V=1 all</span></span><br></pre></td></tr></table></figure><p><strong>å‚è€ƒ</strong>ï¼š</p><p><a href="https://blog.csdn.net/SweeNeil/article/details/83684565">https://blog.csdn.net/SweeNeil/article/details/83684565</a><br><a href="https://blog.csdn.net/qq_42793254/article/details/103074998">https://blog.csdn.net/qq_42793254/article/details/103074998</a></p><h1 id="åˆ‡æ¢å†…æ ¸ç‰ˆæœ¬"><a href="#åˆ‡æ¢å†…æ ¸ç‰ˆæœ¬" class="headerlink" title="åˆ‡æ¢å†…æ ¸ç‰ˆæœ¬"></a>åˆ‡æ¢å†…æ ¸ç‰ˆæœ¬</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹å¯ç”¨å†…æ ¸ä¿¡æ¯</span></span><br><span class="line">grep menuentry /boot/grub/grub.cfg </span><br><span class="line"></span><br><span class="line">sudo vim /etc/default/grub</span><br><span class="line"><span class="comment"># å†™å…¥GRUB_DEFAULT=&quot;Advanced options for Ubuntu &gt; Ubuntu, with Linux 4.18.0-18-generic&quot;</span></span><br><span class="line"><span class="comment"># å…¶ä¸­Linux 4.18.0-18-genericä¸ºä½ æƒ³åˆ‡æ¢åˆ°çš„ç‰ˆæœ¬</span></span><br><span class="line"></span><br><span class="line">sudo update-grub </span><br><span class="line"></span><br><span class="line"><span class="comment"># ç„¶åé‡å¯ç”µè„‘ </span></span><br><span class="line">sudo reboot</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹å½“å‰å†…æ ¸ç‰ˆæœ¬</span></span><br><span class="line"><span class="built_in">uname</span> -r</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> linuxå­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
            <tag> linuxå†…æ ¸ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¼€æºé¡¹ç›®toktikç¯å¢ƒæ­å»º</title>
      <link href="/posts/9673.html"/>
      <url>/posts/9673.html</url>
      
        <content type="html"><![CDATA[<p>é¡¹ç›®åœ°å€ğŸ¶ï¼š<a href="https://github.com/Toktik-Team/toktik/blob/main/README_zh-CN.md">https://github.com/Toktik-Team/toktik/blob/main/README_zh-CN.md</a></p><h1 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h1><p>ubuntu18.04  | å†…æ ¸ç‰ˆæœ¬ï¼šLinux5.15.1</p><h1 id="linuxä¸‹å®‰è£…go1-19"><a href="#linuxä¸‹å®‰è£…go1-19" class="headerlink" title="linuxä¸‹å®‰è£…go1.19"></a>linuxä¸‹å®‰è£…go1.19</h1><p>æ³¨æ„ï¼šè¯¥é¡¹ç›®ä¸æ”¯æŒgo1.21.0ç‰ˆæœ¬ï¼</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åœ¨/usr/localç›®å½•ä¸‹è½½å®‰è£…åŒ… </span></span><br><span class="line">sudo wget https://go.dev/dl/go1.19.linux-amd64.tar.gz</span><br><span class="line"><span class="comment"># åœ¨/usr/localç›®å½•ä¸‹è¿›è¡Œè§£å‹</span></span><br><span class="line">sudo tar -C /usr/local -xzf go1.19.linux-amd64.tar.gz</span><br><span class="line"></span><br><span class="line">vim ~/.profile</span><br><span class="line"></span><br><span class="line"><span class="comment"># åœ¨profileæ–‡ä»¶ä¸­æ·»åŠ ä»£ç†å’Œç¯å¢ƒå˜é‡</span></span><br><span class="line"><span class="built_in">export</span> GOPROXY=https://goproxy.cn</span><br><span class="line"><span class="built_in">export</span> GOPATH=<span class="variable">$HOME</span>/app/go </span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:/usr/local/go/bin:<span class="variable">$GOPATH</span>/bin</span><br><span class="line"></span><br><span class="line"><span class="built_in">source</span> ~/.profile</span><br><span class="line"></span><br><span class="line"><span class="comment">#å®‰è£…é¡¹ç›®æ‰€éœ€åŒ…</span></span><br><span class="line">go install github.com/cloudwego/kitex/tool/cmd/kitex@latest</span><br><span class="line">go install github.com/cloudwego/thriftgo@latest</span><br><span class="line"></span><br><span class="line"><span class="comment"># æµ‹è¯•æ˜¯å¦å®‰è£…æˆåŠŸ</span></span><br><span class="line">kitex --versio</span><br><span class="line">thriftgo --version</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="linuxä¸‹å®‰è£…FFmpeg"><a href="#linuxä¸‹å®‰è£…FFmpeg" class="headerlink" title="linuxä¸‹å®‰è£…FFmpeg"></a>linuxä¸‹å®‰è£…FFmpeg</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install FFmpeg</span><br></pre></td></tr></table></figure><h1 id="linuxä¸‹å®‰è£…PostgreSQL"><a href="#linuxä¸‹å®‰è£…PostgreSQL" class="headerlink" title="linuxä¸‹å®‰è£…PostgreSQL"></a>linuxä¸‹å®‰è£…PostgreSQL</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install postgresql</span><br></pre></td></tr></table></figure><h1 id="linuxä¸‹å®‰è£…Redis"><a href="#linuxä¸‹å®‰è£…Redis" class="headerlink" title="linuxä¸‹å®‰è£…Redis"></a>linuxä¸‹å®‰è£…Redis</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install redis-server</span><br></pre></td></tr></table></figure><h1 id="linuxä¸‹å®‰è£…OpenTelemetry-Collector"><a href="#linuxä¸‹å®‰è£…OpenTelemetry-Collector" class="headerlink" title="linuxä¸‹å®‰è£…OpenTelemetry Collector"></a>linuxä¸‹å®‰è£…OpenTelemetry Collector</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo wget https://github.com/open-telemetry/opentelemetry-collector-releases/releases/download/v0.84.0/otelcol_0.84.0_linux_amd64.deb</span><br><span class="line"></span><br><span class="line">sudo dpkg -i otelcol_0.84.0_linux_amd64.deb</span><br><span class="line"></span><br><span class="line">./ocb_0.44.0_linux_amd64 --config=<span class="string">&quot;./otel-config.yaml&quot;</span></span><br></pre></td></tr></table></figure><h1 id="è¿è¡Œé¡¹ç›®"><a href="#è¿è¡Œé¡¹ç›®" class="headerlink" title="è¿è¡Œé¡¹ç›®"></a>è¿è¡Œé¡¹ç›®</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£…å…¶å®ƒä¾èµ–åŒ…</span></span><br><span class="line">sudo apt install libavcodec-dev libavformat-dev libswscale-dev libavutil-dev</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ„å»ºæ‰€æœ‰æœåŠ¡</span></span><br><span class="line"><span class="built_in">cd</span> toktik</span><br><span class="line">sudo ./build-all.sh</span><br></pre></td></tr></table></figure><p>ç„¶åå°±å¯ä»¥è¿è¡Œé¡¹ç›®å•¦~</p>]]></content>
      
      
      <categories>
          
          <category> ç ”ä¸€è°ƒç ” </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è½¯ä»¶å¼€å‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>linuxå†…å­˜ç®¡ç†æ¨¡å—ä¸€äº›å‡½æ•°ä»‹ç»</title>
      <link href="/posts/35092.html"/>
      <url>/posts/35092.html</url>
      
        <content type="html"><![CDATA[<h1 id="æ¦‚è§ˆ"><a href="#æ¦‚è§ˆ" class="headerlink" title="æ¦‚è§ˆ"></a>æ¦‚è§ˆ</h1><p>æœ¬æ–‡ä»‹ç»äº†internal_get_user_pages_fastã€gup_pgd_rangeã€gup_pte_rangeã€try_grab_compound_head</p><h1 id="internal-get-user-pages-fast"><a href="#internal-get-user-pages-fast" class="headerlink" title="internal_get_user_pages_fast"></a>internal_get_user_pages_fast</h1><p>è¿™æ˜¯ä¸€ä¸ªç”¨äºè·å–ç”¨æˆ·ç©ºé—´é¡µé¢çš„å‡½æ•°ï¼Œå‡½æ•°åŸå‹å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> <span class="type">int</span> <span class="title function_">internal_get_user_pages_fast</span><span class="params">(<span class="type">unsigned</span> <span class="type">long</span> start, <span class="type">int</span> nr_pages,</span></span><br><span class="line"><span class="params"><span class="type">unsigned</span> <span class="type">int</span> gup_flags,</span></span><br><span class="line"><span class="params"><span class="keyword">struct</span> page **pages)</span></span><br></pre></td></tr></table></figure><h3 id="å‚æ•°ï¼š"><a href="#å‚æ•°ï¼š" class="headerlink" title="å‚æ•°ï¼š"></a>å‚æ•°ï¼š</h3><ul><li><code>start</code>ï¼šè¦è·å–çš„ç”¨æˆ·ç©ºé—´èµ·å§‹åœ°å€ã€‚</li><li><code>nr_pages</code>ï¼šè¦è·å–çš„é¡µé¢æ•°é‡ã€‚</li><li><code>gup_flags</code>ï¼šç”¨äºæŒ‡å®šé¡µé¢ç‰¹æ€§å’Œè¡Œä¸ºçš„æ ‡å¿—ã€‚</li><li><code>pages</code>ï¼šæŒ‡å‘ä¸€ä¸ª<code>struct page</code>æŒ‡é’ˆçš„æ•°ç»„ï¼Œå­˜å‚¨è·å–åˆ°çš„é¡µé¢çš„æŒ‡é’ˆã€‚</li></ul><p>å‡½æ•°è¿”å›è·å–åˆ°çš„é¡µé¢æ•°é‡ï¼Œæˆ–è€…åœ¨å‡ºé”™æ—¶è¿”å›è´Ÿçš„é”™è¯¯ä»£ç ã€‚</p><h3 id="å‡½æ•°çš„ä¸»è¦æ­¥éª¤å¦‚ä¸‹ï¼š"><a href="#å‡½æ•°çš„ä¸»è¦æ­¥éª¤å¦‚ä¸‹ï¼š" class="headerlink" title="å‡½æ•°çš„ä¸»è¦æ­¥éª¤å¦‚ä¸‹ï¼š"></a>å‡½æ•°çš„ä¸»è¦æ­¥éª¤å¦‚ä¸‹ï¼š</h3><ol><li>è¿›è¡Œå‚æ•°æ£€æŸ¥ï¼Œç¡®ä¿ä¼ å…¥çš„<code>gup_flags</code>æ˜¯åˆæ³•çš„ç»„åˆã€‚</li><li>å¦‚æœè®¾ç½®äº†<code>FOLL_PIN</code>æ ‡è®°ï¼Œå°†å½“å‰è¿›ç¨‹çš„å†…å­˜ç®¡ç†ç»“æ„ä¸­çš„<code>has_pinned</code>åŸå­å˜é‡è®¾ä¸º1ã€‚</li><li>å¦‚æœæ²¡æœ‰è®¾ç½®<code>FOLL_FAST_ONLY</code>æ ‡è®°ï¼Œä½¿ç”¨<code>might_lock_read</code>å®æç¤ºå¯èƒ½ä¼šå¯¹<code>mmap_lock</code>è¯»é”è¿›è¡ŒåŠ é”ã€‚</li><li>è®¡ç®—èµ·å§‹åœ°å€ã€ç»“æŸåœ°å€å’Œåœ°å€èŒƒå›´é•¿åº¦ï¼Œç¡®ä¿å®ƒä»¬æ˜¯æœ‰æ•ˆçš„ã€‚</li><li>ç¦ç”¨ä¸­æ–­ï¼Œé˜»æ­¢é¡µé¢è¡¨é¡µé¢åœ¨æ“ä½œæœŸé—´è¢«é‡Šæ”¾ã€‚</li><li>å¦‚æœå¯ç”¨äº†<code>CONFIG_HAVE_FAST_GUP</code>é…ç½®ï¼Œå¹¶ä¸”å…è®¸å¿«é€ŸGUPï¼ˆGet User Pagesï¼‰æ“ä½œï¼Œåˆ™è°ƒç”¨<code>gup_pgd_range</code>å‡½æ•°è·å–é¡µé¢ï¼Œå°†è·å–åˆ°çš„é¡µé¢æ•°é‡å­˜å‚¨åœ¨<code>nr_pinned</code>å˜é‡ä¸­ã€‚</li><li>å¦‚æœæ²¡æœ‰è·å–åˆ°æ‰€æœ‰è¯·æ±‚çš„é¡µé¢å¹¶ä¸”æ²¡æœ‰è®¾ç½®<code>FOLL_FAST_ONLY</code>æ ‡è®°ï¼Œåˆ™å°è¯•ä½¿ç”¨<code>__gup_longterm_unlocked</code>å‡½æ•°è·å–å‰©ä½™çš„é¡µé¢ã€‚</li><li>æ ¹æ®å·²è·å–é¡µé¢çš„æ•°é‡å’Œå‰©ä½™é¡µé¢å°è¯•çš„ç»“æœï¼Œè¿”å›æœ€ç»ˆç»“æœã€‚</li></ol><p>è¿™ä¸ªå‡½æ•°çš„ä¸»è¦ä½œç”¨æ˜¯å°è¯•ä½¿ç”¨å¿«é€ŸGUPï¼ˆGet User Pagesï¼‰æ–¹æ³•è·å–ç”¨æˆ·ç©ºé—´å†…å­˜é¡µé¢ã€‚å¦‚æœå¿«é€Ÿæ–¹æ³•ä¸èƒ½è·å–æ‰€æœ‰è¯·æ±‚çš„é¡µé¢ï¼Œå®ƒè¿˜å¯ä»¥å°è¯•ä½¿ç”¨å…¶ä»–æ–¹æ³•è·å–å‰©ä½™çš„é¡µé¢ã€‚è¿™ä¸ªå‡½æ•°ä¼šåœ¨è®¿é—®ç”¨æˆ·ç©ºé—´å†…å­˜æ—¶ä½¿ç”¨ï¼Œä¾‹å¦‚åœ¨å†…æ ¸å¤„ç†ç”¨æˆ·è¯·æ±‚æ—¶ã€‚</p><h1 id="gup-pgd-range"><a href="#gup-pgd-range" class="headerlink" title="gup_pgd_range"></a>gup_pgd_range</h1><p>è¿™æ˜¯ä¸€ä¸ªåˆ†æé¡µå…¨å±€ç›®å½•ï¼ˆPGDï¼‰èŒƒå›´çš„å‡½æ•°ï¼Œç”¨äºå°†è™šæ‹Ÿåœ°å€èŒƒå›´æ˜ å°„åˆ°ç‰©ç†å†…å­˜é¡µé¢ã€‚è¿™ä¸ªå‡½æ•°è¢«å®šä¹‰ä¸ºÂ <code>static void gup_pgd_range</code>ï¼Œå®ƒæ¥æ”¶ä»¥ä¸‹å‚æ•°ï¼š</p><ol><li><code>unsigned long addr</code>ï¼šèµ·å§‹è™šæ‹Ÿåœ°å€ã€‚</li><li><code>unsigned long end</code>ï¼šç»“æŸè™šæ‹Ÿåœ°å€ã€‚</li><li><code>unsigned int flags</code>ï¼šæ ‡å¿—ï¼Œç”¨äºæŒ‡å®šå¤„ç†æ–¹å¼ã€‚</li><li><code>struct page **pages</code>ï¼šæŒ‡å‘é¡µé¢ç»“æ„æ•°ç»„çš„æŒ‡é’ˆã€‚</li><li><code>int *nr</code>ï¼šæŒ‡å‘å­˜å‚¨å½“å‰å·²å¤„ç†é¡µé¢æ•°é‡çš„æ•´æ•°çš„æŒ‡é’ˆã€‚</li></ol><p>å‡½æ•°é¦–å…ˆé€šè¿‡è°ƒç”¨Â <code>pgd_offset(current-&gt;mm, addr)</code>Â è·å–å½“å‰è¿›ç¨‹å†…å­˜ç®¡ç†ç»“æ„ï¼ˆ<code>current-&gt;mm</code>ï¼‰å¯¹åº”çš„é¡µå…¨å±€ç›®å½•é¡¹æŒ‡é’ˆÂ <code>pgdp</code>ã€‚æ¥ä¸‹æ¥ï¼Œå®ƒä½¿ç”¨ä¸€ä¸ªÂ <code>do-while</code>Â å¾ªç¯éå†ä»Â <code>addr</code>Â åˆ°Â <code>end</code>Â çš„è™šæ‹Ÿåœ°å€èŒƒå›´ã€‚</p><p>åœ¨å¾ªç¯ä¸­ï¼Œé¦–å…ˆè·å–å½“å‰Â <code>pgdp</code>Â æŒ‡å‘çš„é¡µå…¨å±€ç›®å½•é¡¹Â <code>pgd</code>ã€‚ç„¶åè°ƒç”¨Â <code>pgd_addr_end(addr, end)</code>Â è®¡ç®—ä¸‹ä¸€ä¸ªè™šæ‹Ÿåœ°å€æ®µçš„ç»“æŸåœ°å€ï¼Œå­˜å‚¨åœ¨Â <code>next</code>Â å˜é‡ä¸­ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œå‡½æ•°æ£€æŸ¥å½“å‰Â <code>pgd</code>Â æ˜¯å¦ä¸ºç©ºï¼ˆ<code>pgd_none(pgd)</code>ï¼‰ã€‚å¦‚æœä¸ºç©ºï¼Œå‡½æ•°ç›´æ¥è¿”å›ã€‚</p><p>å¦‚æœå½“å‰Â <code>pgd</code>Â æ˜¯ä¸€ä¸ªå·¨å¤§çš„é¡µè¡¨é¡¹ï¼ˆ<code>pgd_huge(pgd)</code>ï¼‰ï¼Œå‡½æ•°è°ƒç”¨Â <code>gup_huge_pgd</code>Â å¤„ç†å·¨å¤§é¡µè¡¨é¡¹ã€‚å¦åˆ™ï¼Œå¦‚æœå½“å‰Â <code>pgd</code>Â æ˜¯ä¸€ä¸ªå·¨å¤§é¡µè¡¨ç›®å½•ï¼ˆ<code>is_hugepd(__hugepd(pgd_val(pgd)))</code>ï¼‰ï¼Œå‡½æ•°è°ƒç”¨Â <code>gup_huge_pd</code>Â å¤„ç†å·¨å¤§é¡µè¡¨ç›®å½•ã€‚æœ€åï¼Œå¦‚æœéƒ½ä¸æ˜¯ä¸Šè¿°æƒ…å†µï¼Œå‡½æ•°è°ƒç”¨Â <code>gup_p4d_range</code>Â å¤„ç†ä¸‹ä¸€çº§é¡µè¡¨ã€‚</p><p>åœ¨ä»»ä½•æƒ…å†µä¸‹ï¼Œå¦‚æœå¤„ç†å¤±è´¥ï¼ˆè¿”å›å€¼ä¸º 0ï¼‰ï¼Œå‡½æ•°ç«‹å³è¿”å›ã€‚å¦åˆ™ï¼Œåœ¨å¾ªç¯æ¡ä»¶ä¸­æ›´æ–°Â <code>pgdp</code>ã€<code>addr</code>Â å’ŒÂ <code>next</code>ï¼Œå¹¶ç»§ç»­éå†è™šæ‹Ÿåœ°å€èŒƒå›´ã€‚</p><p>æ€»çš„æ¥è¯´ï¼Œè¿™ä¸ªå‡½æ•°éå†è™šæ‹Ÿåœ°å€èŒƒå›´ï¼ŒæŸ¥æ‰¾å¹¶å¤„ç†ä¸è™šæ‹Ÿåœ°å€å¯¹åº”çš„ç‰©ç†å†…å­˜é¡µé¢ã€‚æ ¹æ®ä¸åŒçš„é¡µè¡¨é¡¹ç±»å‹ï¼ˆå·¨å¤§é¡µè¡¨é¡¹ã€å·¨å¤§é¡µè¡¨ç›®å½•ç­‰ï¼‰ï¼Œå®ƒä¼šè°ƒç”¨ä¸åŒçš„å‡½æ•°æ¥å¤„ç†è¿™äº›é¡¹ã€‚</p><h1 id="gup-pte-range"><a href="#gup-pte-range" class="headerlink" title="gup_pte_range"></a>gup_pte_range</h1><p>è¿™æ®µä»£ç å®ç°äº†ä¸€ä¸ªå‡½æ•°Â <code>gup_pte_range()</code>ï¼Œç”¨äºè·å–ä¸€ä¸ªè™šæ‹Ÿåœ°å€èŒƒå›´å†…çš„ç‰©ç†é¡µæ¡†ï¼Œå¹¶è¿”å›è¿™äº›é¡µæ¡†æ‰€å¯¹åº”çš„Â <code>struct page</code>Â æ•°ç»„å’Œé¡µæ¡†æ•°é‡ã€‚ä¸‹é¢æ˜¯å¯¹è¿™æ®µä»£ç çš„åˆ†æï¼š</p><ol><li>é¦–å…ˆå®šä¹‰äº†ä¸€äº›å˜é‡ï¼ŒåŒ…æ‹¬Â <code>pgmap</code>ã€<code>nr_start</code>Â å’ŒÂ <code>ret</code>Â ç­‰ã€‚å…¶ä¸­Â <code>pgmap</code>Â æ˜¯ä¸€ä¸ªæŒ‡å‘Â <code>dev_pagemap</code>Â ç»“æ„ä½“çš„æŒ‡é’ˆï¼Œç”¨äºæ˜ å°„è®¾å¤‡å†…å­˜ã€‚<code>nr_start</code>Â è¡¨ç¤ºè·å–é¡µæ¡†çš„èµ·å§‹æ•°é‡ï¼Œ<code>ret</code>Â è¡¨ç¤ºå‡½æ•°çš„è¿”å›å€¼ã€‚</li><li>ç„¶åé€šè¿‡Â <code>pte_offset_map()</code>Â å‡½æ•°è·å–ä¸€ä¸ªÂ <code>pte_t</code>Â ç±»å‹çš„æŒ‡é’ˆÂ <code>ptep</code>ï¼Œè¯¥æŒ‡é’ˆæŒ‡å‘ä¸€ä¸ªé¡µè¡¨é¡¹ï¼ˆ<code>pte</code>ï¼‰çš„åœ°å€ã€‚åŒæ—¶å°†Â <code>ptep</code>Â èµ‹å€¼ç»™Â <code>ptem</code>ï¼Œä½œä¸ºå¾ªç¯ä¸­çš„åˆå§‹å€¼ã€‚</li><li>ä½¿ç”¨ä¸€ä¸ªÂ <code>do-while</code>Â å¾ªç¯ï¼Œéå†åœ°å€èŒƒå›´å†…çš„æ‰€æœ‰é¡µè¡¨é¡¹ã€‚å¾ªç¯å†…éƒ¨å¯¹æ¯ä¸ªé¡µè¡¨é¡¹è¿›è¡Œå¤„ç†ï¼Œå…·ä½“æ“ä½œå¦‚ä¸‹ï¼š</li></ol><ul><li>ä½¿ç”¨Â <code>gup_get_pte()</code>Â å‡½æ•°è·å–é¡µè¡¨é¡¹çš„å€¼ï¼Œå¹¶èµ‹å€¼ç»™Â <code>pte</code>Â å˜é‡ã€‚</li><li>å¦‚æœÂ <code>pte</code>Â çš„ä¿æŠ¤ä½ï¼ˆprotnoneï¼‰è¢«è®¾ç½®ï¼Œè¯´æ˜è¿™ä¸ªé¡µè¡¨é¡¹ä¸å¯è®¿é—®ï¼Œç›´æ¥è·³è½¬åˆ°Â <code>pte_unmap</code>Â æ ‡ç­¾å¤„æ¸…ç†é¡µé¢æ˜ å°„ã€‚</li><li>å¦‚æœÂ <code>flags</code>Â ä¸­åŒ…å« FOLL_WRITE æ ‡å¿—ä½ï¼Œä½†Â <code>pte</code>Â ä¸­çš„å†™å…¥æƒé™è¢«ç¦ç”¨ï¼Œåˆ™ä¹Ÿè·³è½¬åˆ°Â <code>pte_unmap</code>Â æ ‡ç­¾å¤„æ¸…ç†é¡µé¢æ˜ å°„ã€‚</li><li>å¦‚æœÂ <code>pte</code>Â æ˜¯è®¾å¤‡æ˜ å°„é¡µï¼Œåˆ™è¿›ä¸€æ­¥å¤„ç†ã€‚å¦‚æœÂ <code>flags</code>Â ä¸­åŒ…å« FOLL_LONGTERM æ ‡å¿—ä½ï¼Œåˆ™ä¹Ÿè·³è½¬åˆ°Â <code>pte_unmap</code>Â æ ‡ç­¾å¤„æ¸…ç†é¡µé¢æ˜ å°„ã€‚å¦åˆ™ï¼Œè°ƒç”¨Â <code>get_dev_pagemap()</code>Â å‡½æ•°è·å–è®¾å¤‡æ˜ å°„çš„Â <code>dev_pagemap</code>Â ç»“æ„ä½“ï¼Œå¹¶å°†å…¶èµ‹å€¼ç»™Â <code>pgmap</code>Â å˜é‡ã€‚å¦‚æœè·å–å¤±è´¥ï¼Œåˆ™è·³è½¬åˆ°Â <code>pte_unmap</code>Â æ ‡ç­¾å¤„æ¸…ç†é¡µé¢æ˜ å°„ã€‚</li><li>å¦‚æœÂ <code>pte</code>Â æ˜¯ä¸€ä¸ªç‰¹æ®Šé¡µï¼Œåˆ™ä¹Ÿè·³è½¬åˆ°Â <code>pte_unmap</code>Â æ ‡ç­¾å¤„æ¸…ç†é¡µé¢æ˜ å°„ã€‚</li><li>æ£€æŸ¥Â <code>pte</code>Â æ‰€å¯¹åº”çš„ç‰©ç†é¡µæ¡†æ˜¯å¦æœ‰æ•ˆï¼Œå¦‚æœæ— æ•ˆåˆ™ä¼šè§¦å‘ BUGï¼Œç¨‹åºä¼šåœæ­¢è¿è¡Œã€‚</li><li>è°ƒç”¨Â <code>pte_page()</code>Â å‡½æ•°è·å–Â <code>pte</code>Â æ‰€å¯¹åº”çš„Â <code>struct page</code>Â ç»“æ„ä½“ï¼Œå¹¶å°†å…¶èµ‹å€¼ç»™Â <code>page</code>Â å˜é‡ã€‚</li><li>å¦‚æœÂ <code>page</code>Â æ˜¯ä¸€ä¸ªå¤åˆé¡µï¼Œåˆ™è°ƒç”¨Â <code>try_grab_compound_head()</code>Â å‡½æ•°è·å–è¯¥é¡µçš„å¤´éƒ¨é¡µæ¡†ï¼Œå¹¶å°†å…¶èµ‹å€¼ç»™Â <code>head</code>Â å˜é‡ã€‚å¦‚æœè·å–å¤±è´¥ï¼Œåˆ™è·³è½¬åˆ°Â <code>pte_unmap</code>Â æ ‡ç­¾å¤„æ¸…ç†é¡µé¢æ˜ å°„ã€‚</li><li>æ£€æŸ¥Â <code>pte</code>Â çš„å€¼æ˜¯å¦ä¸Â <code>ptep</code>Â çš„å€¼ç›¸ç­‰ï¼Œå¦‚æœä¸ç›¸ç­‰ï¼Œåˆ™è¯´æ˜é¡µè¡¨é¡¹å·²ç»è¢«ä¿®æ”¹è¿‡ï¼Œç›´æ¥è·³è½¬åˆ°Â <code>pte_unmap</code>Â æ ‡ç­¾å¤„æ¸…ç†é¡µé¢æ˜ å°„ã€‚</li><li>æ£€æŸ¥Â <code>compound_head(page)</code>Â æ˜¯å¦ç­‰äºÂ <code>head</code>ï¼Œå¦‚æœä¸ç­‰äºï¼Œåˆ™è¯´æ˜Â <code>page</code>Â ä¸æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„å¤åˆé¡µï¼Œç›´æ¥è§¦å‘ BUGï¼Œç¨‹åºä¼šåœæ­¢è¿è¡Œã€‚</li><li>å¦‚æœÂ <code>flags</code>Â ä¸­åŒ…å« FOLL_PIN æ ‡å¿—ä½ï¼Œåˆ™è°ƒç”¨Â <code>arch_make_page_accessible()</code>Â å‡½æ•°ä½¿Â <code>page</code>Â å¯è®¿é—®ã€‚å¦‚æœæ“ä½œå¤±è´¥ï¼Œåˆ™è°ƒç”¨Â <code>unpin_user_page()</code>Â å‡½æ•°è§£é™¤é¡µé¢é”å®šï¼Œå¹¶è·³è½¬åˆ°Â <code>pte_unmap</code>Â æ ‡ç­¾å¤„æ¸…ç†é¡µé¢æ˜ å°„ã€‚</li><li>è°ƒç”¨Â <code>SetPageReferenced()</code>Â å‡½æ•°æ ‡è®°Â <code>page</code>Â å·²è¢«å¼•ç”¨è¿‡ã€‚</li><li>å°†Â <code>page</code>Â å­˜å‚¨åˆ°Â <code>pages</code>Â æ•°ç»„ä¸­ï¼Œå¹¶å°†Â <code>nr</code>Â çš„å€¼å¢åŠ  1ã€‚</li></ul><ol><li>å¾ªç¯ç»“æŸåï¼Œå¦‚æœå‡½æ•°æ²¡æœ‰è¢«è·³è½¬åˆ°Â <code>pte_unmap</code>Â æ ‡ç­¾å¤„ï¼Œåˆ™å°†Â <code>ret</code>Â çš„å€¼è®¾ä¸º 1ï¼Œè¡¨ç¤ºå‡½æ•°æ‰§è¡ŒæˆåŠŸã€‚ç„¶åè°ƒç”¨Â <code>put_dev_pagemap()</code>Â å‡½æ•°é‡Šæ”¾Â <code>pgmap</code>Â å ç”¨çš„èµ„æºï¼Œå¹¶è°ƒç”¨Â <code>pte_unmap()</code>Â å‡½æ•°è§£é™¤é¡µé¢æ˜ å°„ã€‚</li><li>æœ€åè¿”å›Â <code>ret</code>Â çš„å€¼ï¼Œè¡¨ç¤ºå‡½æ•°æ‰§è¡Œç»“æœçš„çŠ¶æ€ã€‚</li></ol><h1 id="try-grab-compound-head"><a href="#try-grab-compound-head" class="headerlink" title="try_grab_compound_head"></a>try_grab_compound_head</h1><p>å®ƒçš„ä½œç”¨æ˜¯å°è¯•æ ¹æ®æ ‡å¿—ä½(flags)å¢åŠ ä¸€ä¸ªç»™å®šé¡µé¢ï¼ˆpageï¼‰çš„å¼•ç”¨è®¡æ•°ã€‚åœ¨æ­¤æ–‡ä»¶ä¸­ï¼Œâ€œgrabâ€è¡¨ç¤ºï¼šæ ¹æ®æ ‡å¿—ä½å†³å®šæ˜¯ä½¿ç”¨FOLL_PINè¿˜æ˜¯FOLL_GETè¡Œä¸ºæ¥å¢åŠ é¡µé¢çš„å¼•ç”¨è®¡æ•°ã€‚</p><p>å‡½æ•°çš„å‚æ•°å¦‚ä¸‹ï¼š</p><ul><li><code>struct page *page</code>ï¼šè¦æ“ä½œçš„é¡µé¢ã€‚</li><li><code>int refs</code>ï¼šå½“å‰é¡µé¢çš„å¼•ç”¨è®¡æ•°ã€‚</li><li><code>unsigned int flags</code>ï¼šæ§åˆ¶è¡Œä¸ºçš„æ ‡å¿—ä½ï¼ŒåŒ…æ‹¬FOLL_GETå’ŒFOLL_PINã€‚</li></ul><p>åœ¨è¿™ä¸ªå‡½æ•°ä¸­ï¼ŒFOLL_GETå’ŒFOLL_PINï¼ˆæˆ–è€…å®ƒä»¬éƒ½æ²¡æœ‰ï¼‰å¿…é¡»è¢«è®¾ç½®ï¼Œä½†ä¸èƒ½åŒæ—¶è®¾ç½®ã€‚å®ƒä»¬çš„å«ä¹‰å¦‚ä¸‹ï¼š</p><ul><li>FOLL_GETï¼šé¡µé¢çš„å¼•ç”¨è®¡æ•°å°†å¢åŠ 1ã€‚</li><li>FOLL_PINï¼šé¡µé¢çš„å¼•ç”¨è®¡æ•°å°†å¢åŠ GUP_PIN_COUNTING_BIASã€‚</li></ul><p>æ ¹æ®flagsçš„è®¾ç½®ï¼Œå‡½æ•°ä¼šè¿”å›é€‚å½“å¢åŠ å¼•ç”¨è®¡æ•°çš„å¤´é¡µé¢ï¼ˆhead pageï¼‰ï¼Œå¦‚æœå¤±è´¥åˆ™è¿”å›NULLã€‚å¦‚æœæ²¡æœ‰è®¾ç½®FOLL_GETæˆ–FOLL_PINï¼Œé‚£ä¹ˆè¿™è¢«è®¤ä¸ºæ˜¯å¤±è´¥ï¼ŒåŒæ—¶ä¹Ÿå¯èƒ½æ˜¯è°ƒç”¨è€…çš„bugï¼Œå› æ­¤è¿˜ä¼šå‘å‡ºè­¦å‘Šã€‚</p><p>å‡½æ•°çš„ä¸»ä½“åŒ…å«å‡ ä¸ªæ¡ä»¶åˆ†æ”¯ï¼š</p><ol><li>å¦‚æœè®¾ç½®äº†FOLL_GETï¼Œè°ƒç”¨<code>try_get_compound_head</code>å‡½æ•°ï¼Œå‚æ•°ä¸º<code>page</code>å’Œ<code>refs</code>ã€‚</li><li>å¦‚æœè®¾ç½®äº†FOLL_PINï¼Œè¿›è¡Œä»¥ä¸‹æ“ä½œï¼š<ul><li>æ£€æŸ¥æ˜¯å¦åŒæ—¶è®¾ç½®äº†FOLL_LONGTERMï¼Œå¹¶ä¸”é¡µé¢æ˜¯CMAç±»å‹ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å›NULLã€‚</li><li>å¦‚æœé¡µé¢çš„orderå¤§äº1ï¼ˆç”±<code>hpage_pincount_available</code>å‡½æ•°æ£€æŸ¥ï¼‰ï¼Œåˆ™å°†<code>refs</code>ä¹˜ä»¥GUP_PIN_COUNTING_BIASã€‚</li><li>è°ƒç”¨<code>try_get_compound_head</code>å‡½æ•°ï¼Œå‚æ•°ä¸º<code>page</code>å’Œ<code>refs</code>ã€‚</li><li>å¦‚æœé¡µé¢çš„orderå¤§äº1ï¼Œè°ƒç”¨<code>hpage_pincount_add</code>å‡½æ•°å¢åŠ é¡µé¢çš„pinè®¡æ•°ã€‚</li><li>æ›´æ–°èŠ‚ç‚¹çŠ¶æ€ï¼ˆ<code>mod_node_page_state</code>ï¼‰ã€‚</li><li>è¿”å›é€‚å½“å¢åŠ å¼•ç”¨è®¡æ•°çš„å¤´é¡µé¢ã€‚</li></ul></li><li>å¦‚æœæ—¢æ²¡æœ‰è®¾ç½®FOLL_GETï¼Œä¹Ÿæ²¡æœ‰è®¾ç½®FOLL_PINï¼Œå‘å‡ºè­¦å‘Šï¼Œå¹¶è¿”å›NULLã€‚</li></ol><h1 id="try-get-compound-head"><a href="#try-get-compound-head" class="headerlink" title="try_get_compound_head"></a>try_get_compound_head</h1><p>è¿™æ˜¯ä¸€ä¸ªé™æ€å†…è”å‡½æ•°ï¼Œè¿”å›ä¸€ä¸ª<code>struct page</code>ç±»å‹çš„æŒ‡é’ˆï¼Œå¹¶æ¥å—ä¸¤ä¸ªå‚æ•°ï¼š</p><ol><li><code>struct page *page</code>Â - ä¸€ä¸ªæŒ‡å‘<code>struct page</code>ç±»å‹çš„æŒ‡é’ˆï¼Œè¡¨ç¤ºæˆ‘ä»¬è¦è·å–å…¶å¤´éƒ¨çš„å¤åˆé¡µã€‚</li><li><code>int refs</code>Â - ä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæˆ‘ä»¬å¸Œæœ›å¢åŠ çš„å¼•ç”¨è®¡æ•°ã€‚</li></ol><p><code>try_get_compound_head()</code>å‡½æ•°çš„ç›®çš„æ˜¯è·å–å¤åˆé¡µçš„å¤´éƒ¨ï¼Œå¹¶å°†å…¶å¼•ç”¨è®¡æ•°é€‚å½“åœ°å¢åŠ ã€‚å¦‚æœæˆåŠŸï¼Œå‡½æ•°è¿”å›å¤´éƒ¨çš„æŒ‡é’ˆï¼Œå¦åˆ™è¿”å›<code>NULL</code>ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> linuxå­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
            <tag> å†…å­˜ç®¡ç† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/posts/16107.html"/>
      <url>/posts/16107.html</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
